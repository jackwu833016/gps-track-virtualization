<!DOCTYPE html>
<html>
<head>
    <!--Loadin leaflet files-->
     <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
     <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>

     <!--Mapbox files-->
     <script src='https://api.mapbox.com/mapbox.js/v3.1.0/mapbox.standalone.js'></script>
     <link href='https://api.mapbox.com/mapbox.js/v3.1.0/mapbox.css' rel='stylesheet' />

     <!--D3 files-->
     <script src="https://d3js.org/d3.v4.min.js"></script>

</head>

<body>
     <div id="map" style="width: 1000px; height: 700px"></div>
     <script src="functions.js"></script>

     <script>
        L.mapbox.accessToken = 'put your access token here'; 
        var map,
            pace_sample_size = 3, //calculate pace for every pace_sample_size sample
            Lot_array = [], Lat_array = [], Time_array = [], pace_array = [],
            radius_scale;

        d3.csv("sample_gps_track_file.csv")
          .get(function(ArrayOfObject){
              ArrayOfObject.forEach(converter);
              cal_pace(ArrayOfObject);

              map = L.mapbox.map('map', 'mapbox.streets')
               .setView([d3.mean(Lot_array),
                         d3.mean(Lat_array)],
                         14); //init map

             radius_scale = d3.scaleLinear();
                radius_scale.range([0,15]); 
                radius_scale.domain([d3.min(pace_array), d3.max(pace_array)]);
            
             render(); //plotting track
          });
     </script>
     
</body>

</html>
